<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hướng Dẫn Commit Message</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Font: Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: "Inter", sans-serif;
      background-color: #f0f4f8;
      /* Light blue-grey background */
      color: #334155;
      /* Dark slate text */
    }

    .container {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
        0 4px 6px -2px rgba(0, 0, 0, 0.05);
      padding: 2.5rem;
      /* p-10 */
    }

    h1,
    h2,
    h3 {
      color: #1e293b;
      /* Darker slate for headings */
      font-weight: 600;
      /* Semi-bold */
    }

    h1 {
      font-size: 2.25rem;
      /* text-4xl */
      margin-bottom: 1.5rem;
      /* mb-6 */
    }

    h2 {
      font-size: 1.875rem;
      /* text-3xl */
      margin-top: 2.5rem;
      /* mt-10 */
      margin-bottom: 1.25rem;
      /* mb-5 */
      border-bottom: 2px solid #e2e8f0;
      /* Light border */
      padding-bottom: 0.5rem;
    }

    h3 {
      font-size: 1.5rem;
      /* text-2xl */
      margin-top: 2rem;
      /* mt-8 */
      margin-bottom: 0.75rem;
      /* mb-3 */
      color: #475569;
      /* Slightly lighter heading */
    }

    code {
      padding: 0.2em 0.4em;
      border-radius: 0.375rem;
      font-family: monospace;
      font-size: 0.9em;
    }

    pre {
      background-color: #1e293b;
      /* Dark background for code blocks */
      color: #f8fafc;
      /* Light text for code blocks */
      padding: 1rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      margin-top: 1rem;
      margin-bottom: 1rem;
      font-size: 0.9rem;
      line-height: 1.5;
    }

    li {
      margin-bottom: 0.5rem;
      list-style-type: disc;
      margin-left: 1.25rem;
      /* pl-5 */
    }

    ul {
      margin-bottom: 1rem;
    }

    strong {
      color: #334155;
    }

    /* Custom styles for the loader */
    .loader {
      border: 4px solid #f3f3f3;
      /* Light grey */
      border-top: 4px solid #3498db;
      /* Blue */
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 2s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body class="p-6 md:p-10 min-h-screen flex items-center justify-center">
  <div class="container max-w-4xl w-full mx-auto p-6 md:p-10 rounded-xl shadow-lg">
    <h1 class="text-4xl text-center font-bold mb-6 text-indigo-700">
      Quy Ước Commit Message
    </h1>
    <p class="text-lg mb-8 text-center text-gray-700">
      Viết commit message rõ ràng là chìa khóa để quản lý dự án hiệu quả. Một
      commit message tốt giúp đồng đội (và chính bạn trong tương lai) nhanh
      chóng hiểu được mục đích và nội dung của từng thay đổi.
    </p>
    <p class="text-lg mb-8 text-center text-gray-700">
      Chúng ta sẽ sử dụng các **tiền tố** chuẩn để phân loại commit, giúp lịch
      sử dự án gọn gàng và dễ tìm kiếm.
    </p>

    <!-- New Section for Gemini API Integration -->
    <h2 class="text-3xl font-semibold mt-10 mb-5 pb-2 border-b-2 border-gray-200">
      ✨ Tạo Commit Message Tự Động với AI
    </h2>
    <p class="mb-6 text-gray-700">
      Mô tả ngắn gọn thay đổi bạn đã thực hiện trong code của mình (ví dụ:
      "Sửa lỗi hiển thị sản phẩm trên trang chủ", "Thêm tính năng đăng nhập
      bằng Google"). AI sẽ giúp bạn tạo ra một commit message chuẩn theo quy
      ước!
    </p>

    <div class="mb-8 p-6 bg-blue-50 rounded-lg border border-blue-200">
      <label for="codeChangeDescription" class="block text-gray-800 text-lg font-medium mb-3">Mô tả thay đổi code của bạn:</label>
      <textarea id="codeChangeDescription" rows="5" class="w-full p-3 border border-blue-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-gray-800" placeholder="Ví dụ: Đã thêm nút 'Thêm vào giỏ hàng' vào trang chi tiết sản phẩm và xử lý logic thêm sản phẩm vào local storage."></textarea>
      <button id="generateCommitBtn" class="mt-4 px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 flex items-center justify-center">
        <span id="buttonText">Tạo Commit Message ✨</span>
        <div id="loader" class="loader ml-3 hidden"></div>
      </button>

      <div id="generatedCommitContainer" class="mt-6 hidden">
        <p class="text-gray-800 text-lg font-medium mb-2">
          Commit Message Đề Xuất:
        </p>
        <pre><code id="generatedCommitMessage" class="language-text p-4 rounded-md"></code></pre>
        <button id="copyCommitBtn" class="mt-3 px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2">
          Sao chép
        </button>
        <span id="copyFeedback" class="ml-3 text-sm text-green-600 hidden">Đã sao chép!</span>
      </div>
      <p id="errorMessage" class="text-red-600 mt-4 hidden"></p>
    </div>
    <!-- End New Section -->

    <h2 class="text-3xl font-semibold mt-10 mb-5 pb-2 border-b-2 border-gray-200">
      Cấu Trúc Cơ Bản của Commit Message
    </h2>
    <p class="mb-4 text-gray-700">
      Một commit message lý tưởng thường có cấu trúc như sau:
    </p>
    <pre><code class="language-text">
&lt;kiểu>: &lt;mô tả ngắn gọn, không quá 50 ký tự>

[dòng trống]

[thân commit (tùy chọn): mô tả chi tiết hơn]
        </code></pre>
    <p class="mb-6 text-gray-700">Ví dụ:</p>
    <pre><code class="language-text">
feat: thêm xác thực người dùng qua email và mật khẩu

Commit này giới thiệu một hệ thống xác thực mới cho phép người dùng đăng ký và đăng nhập bằng địa chỉ email và mật khẩu an toàn. Bao gồm:
- Endpoint đăng ký người dùng
- Endpoint đăng nhập với tạo token JWT
- Mã hóa mật khẩu sử dụng bcrypt
- Xử lý lỗi cơ bản cho thông tin đăng nhập không hợp lệ
        </code></pre>

    <h2 class="text-3xl font-semibold mt-10 mb-5 pb-2 border-b-2 border-gray-200">
      Các Kiểu Commit Phổ Biến
    </h2>

    <div class="space-y-8">
      <div>
        <h3 class="text-2xl font-medium text-purple-700">
          <code>feat:</code> (Feature - Tính năng mới)
        </h3>
        <p class="text-gray-700">Khi bạn thêm một tính năng mới vào dự án.</p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Thêm chức năng, giao diện, hoặc bất kỳ điều gì mang lại khả năng mới cho ứng dụng.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">feat: triển khai trang hồ sơ người dùng</code></li>
          <li><code class="language-text">feat: thêm nút chuyển đổi chế độ tối</code></li>
          <li><code class="language-text">feat: tích hợp Stripe cho thanh toán</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-green-700">
          <code>fix:</code> (Bug Fix - Sửa lỗi)
        </h3>
        <p class="text-gray-700">Khi bạn sửa một lỗi nào đó.</p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Khắc phục lỗi khiến ứng dụng hoạt động không đúng hoặc gặp sự cố.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">fix: sửa lỗi vòng lặp vô hạn khi lấy dữ liệu</code></li>
          <li><code class="language-text">fix: khắc phục vấn đề styling trên giao diện di động</code></li>
          <li><code class="language-text">fix: ngăn chặn lỗ hổng XSS trong phần bình luận</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-blue-700">
          <code>docs:</code> (Documentation - Tài liệu)
        </h3>
        <p class="text-gray-700">
          Khi bạn chỉ thay đổi về tài liệu (documentation).
        </p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Cập nhật README, thêm bình luận code, sửa lỗi chính tả trong tài liệu, v.v.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">docs: cập nhật README với hướng dẫn cài đặt</code></li>
          <li><code class="language-text">docs: thêm bình luận vào thuật toán phức tạp</code></li>
          <li><code class="language-text">docs: sửa lỗi chính tả trong CONTRIBUTING.md</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-yellow-700">
          <code>style:</code> (Code Style - Phong cách code)
        </h3>
        <p class="text-gray-700">
          Khi bạn thay đổi liên quan đến định dạng code, không ảnh hưởng đến
          logic.
        </p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Sửa lỗi định dạng, khoảng trắng, dấu chấm phẩy, tuân thủ linter, v.v.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">style: định dạng code với Prettier</code></li>
          <li><code class="language-text">style: thêm dấu chấm phẩy còn thiếu</code></li>
          <li><code class="language-text">style: điều chỉnh thụt lề để dễ đọc</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-red-700">
          <code>refactor:</code> (Refactoring - Tái cấu trúc)
        </h3>
        <p class="text-gray-700">
          Khi bạn thay đổi cấu trúc code mà không sửa lỗi hay thêm tính năng.
        </p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Cải thiện cấu trúc code, tối ưu hiệu suất, làm cho code dễ đọc hơn mà không thay đổi hành vi bên ngoài.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">refactor: tái cấu trúc các route API để tổ chức tốt hơn</code></li>
          <li><code class="language-text">refactor: tách logic xác thực vào tiện ích riêng</code></li>
          <li><code class="language-text">refactor: đổi tên biến để rõ ràng hơn</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-teal-700">
          <code>test:</code> (Tests - Kiểm thử)
        </h3>
        <p class="text-gray-700">
          Khi bạn thêm, sửa đổi hoặc xóa các bài kiểm thử.
        </p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Viết test mới, sửa lỗi trong test hiện có, hoặc xóa test không còn cần thiết.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">test: thêm unit test cho dịch vụ người dùng</code></li>
          <li><code class="language-text">test: sửa lỗi flaky test tích hợp</code></li>
          <li><code class="language-text">test: loại bỏ các test case đã lỗi thời</code></li>
        </ul>
      </div>

      <div>
        <h3 class="text-2xl font-medium text-gray-600">
          <code>chore:</code> (Chores - Công việc lặt vặt)
        </h3>
        <p class="text-gray-700">
          Các thay đổi nhỏ, bảo trì không liên quan trực tiếp đến code ứng
          dụng.
        </p>
        <p class="font-medium text-gray-800">Khi dùng:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li>Cập nhật thư viện, thay đổi cấu hình build, dọn dẹp file không cần thiết, v.v.</li>
        </ul>
        <p class="font-medium text-gray-800">Ví dụ:</p>
        <ul class="list-disc list-inside text-gray-600">
          <li><code class="language-text">chore: cập nhật các dependency</code></li>
          <li><code class="language-text">chore: cấu hình husky hooks</code></li>
          <li><code class="language-text ">chore: xóa các tài sản không sử dụng</code></li>
        </ul>
      </div>
    </div>

    <h2 class="text-3xl font-semibold mt-10 mb-5 pb-2 border-b-2 border-gray-200">
      Các Kiểu Khác (Ít phổ biến hơn)
    </h2>
    <ul class="list-disc list-inside text-gray-600 mb-8 space-y-2">
      <li><strong><code class="language-text">build:</code></strong> Thay đổi liên quan đến hệ thống build hoặc các phụ thuộc bên ngoài (ví dụ: npm, webpack).
        <ul>
          <li>Ví dụ: <code class="language-text">build: cập nhật cấu hình webpack</code></li>
        </ul>
      </li>
      <li><strong><code class="language-text">ci:</code></strong> Thay đổi cấu hình CI/CD (Continuous Integration/Continuous Deployment).
        <ul>
          <li>Ví dụ: <code class="language-text">ci: thêm workflow GitHub Actions</code></li>
        </ul>
      </li>
      <li><strong><code class="language-text">perf:</code></strong> Thay đổi cải thiện hiệu suất.
        <ul>
          <li>Ví dụ: <code class="language-text">perf: tối ưu hóa tốc độ tải ảnh</code></li>
        </ul>
      </li>
      <li><strong><code class="language-text">revert:</code></strong> Hoàn tác (revert) một commit trước đó.
        <ul>
          <li>Ví dụ: <code class="language-text">revert: "feat: thêm tính năng thử nghiệm" - hoàn tác commit trước đó</code></li>
        </ul>
      </li>
    </ul>

    <h2 class="text-3xl font-semibold mt-10 mb-5 pb-2 border-b-2 border-gray-200">
      Tại Sao Nên Tuân Thủ?
    </h2>
    <ul class="list-disc list-inside text-gray-700 space-y-2 mb-8">
      <li><strong>Lịch sử sạch đẹp:</strong> Dễ dàng duyệt và hiểu lịch sử dự án.</li>
      <li><strong>Tạo Changelog tự động: Các công cụ có thể tự động tạo ra danh sách thay đổi (changelog) dựa trên commit message của bạn.</li>
      <li><strong>Tìm kiếm hiệu quả:</strong> Dễ dàng tìm kiếm các commit liên quan đến một tính năng hoặc một bản sửa lỗi cụ thể.</li>
      <li><strong>Giao tiếp tốt hơn:</strong> Giúp đồng đội hiểu nhanh chóng những gì đã thay đổi.</li>
    </ul>
    <p class="text-lg text-center text-gray-800 italic mt-10">
      Việc áp dụng các quy ước này có thể mất một chút thời gian ban đầu,
      nhưng lợi ích về lâu dài chắc chắn sẽ rất đáng giá cho dự án của bạn!
    </p>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const descriptionInput = document.getElementById(
        "codeChangeDescription"
      );
      const generateBtn = document.getElementById("generateCommitBtn");
      const generatedCommitContainer = document.getElementById(
        "generatedCommitContainer"
      );
      const generatedCommitMessage = document.getElementById(
        "generatedCommitMessage"
      );
      const copyCommitBtn = document.getElementById("copyCommitBtn");
      const copyFeedback = document.getElementById("copyFeedback");
      const errorMessage = document.getElementById("errorMessage");
      const loader = document.getElementById("loader");
      const buttonText = document.getElementById("buttonText");

      generateBtn.addEventListener("click", async () => {
        const description = descriptionInput.value.trim();
        if (!description) {
          errorMessage.textContent = "Vui lòng mô tả thay đổi code của bạn.";
          errorMessage.classList.remove("hidden");
          generatedCommitContainer.classList.add("hidden");
          return;
        }

        errorMessage.classList.add("hidden");
        generatedCommitContainer.classList.add("hidden");
        loader.classList.remove("hidden");
        buttonText.textContent = "Đang tạo...";
        generateBtn.disabled = true;

        try {
          const prompt = `Dựa trên mô tả thay đổi code sau, hãy tạo một commit message tuân thủ quy ước Conventional Commits (feat, fix, refactor, docs, style, chore, test, build, ci, perf, revert). Bắt đầu bằng kiểu (type), sau đó là một dấu hai chấm và mô tả ngắn gọn (không quá 50 ký tự), tiếp theo là một dòng trống, và cuối cùng là mô tả chi tiết hơn nếu cần.

Mô tả thay đổi: "${description}"

Ví dụ:
feat: thêm xác thực người dùng qua email và mật khẩu

Commit này giới thiệu một hệ thống xác thực mới cho phép người dùng đăng ký và đăng nhập bằng địa chỉ email và mật khẩu an toàn. Bao gồm:
- Endpoint đăng ký người dùng
- Endpoint đăng nhập với tạo token JWT
- Mã hóa mật khẩu sử dụng bcrypt
- Xử lý lỗi cơ bản cho thông tin đăng nhập không hợp lệ

Tạo commit message bằng tiếng Việt.`;

          let chatHistory = [];
          chatHistory.push({ role: "user", parts: [{ text: prompt }] });
          const payload = { contents: chatHistory };
          const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
          const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

          const response = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          const result = await response.json();

          if (
            result.candidates &&
            result.candidates.length > 0 &&
            result.candidates[0].content &&
            result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0
          ) {
            const text = result.candidates[0].content.parts[0].text;
            generatedCommitMessage.textContent = text.trim();
            generatedCommitContainer.classList.remove("hidden");
          } else {
            errorMessage.textContent =
              "Không thể tạo commit message. Vui lòng thử lại.";
            errorMessage.classList.remove("hidden");
            console.error("Unexpected API response structure:", result);
          }
        } catch (error) {
          errorMessage.textContent =
            "Đã xảy ra lỗi khi kết nối đến AI. Vui lòng thử lại sau.";
          errorMessage.classList.remove("hidden");
          console.error("Error calling Gemini API:", error);
        } finally {
          loader.classList.add("hidden");
          buttonText.textContent = "Tạo Commit Message ✨";
          generateBtn.disabled = false;
        }
      });

      copyCommitBtn.addEventListener("click", () => {
        const textToCopy = generatedCommitMessage.textContent;
        const textarea = document.createElement("textarea");
        textarea.value = textToCopy;
        document.body.appendChild(textarea);
        textarea.select();
        try {
          document.execCommand("copy");
          copyFeedback.classList.remove("hidden");
          setTimeout(() => {
            copyFeedback.classList.add("hidden");
          }, 2000); // Hide after 2 seconds
        } catch (err) {
          console.error("Could not copy text: ", err);
        }
        document.body.removeChild(textarea);
      });
    });
  </script>
</body>

</html>